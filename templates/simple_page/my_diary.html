{% extends "base.html" %}

{% block title %}Приемы пищи{% endblock %}
{% block body_class %}eating{% endblock %}

{% block extra_js %}
    <script src="{{ STATIC_URL }}js/app/eating/controllers.js" type="text/javascript"></script>
    <script src="{{ STATIC_URL }}js/app/food/controllers.js" type="text/javascript"></script>
{% endblock %}

{% block content %}
    <div class="row">
        <div class="span6" ng-controller="EatingController" ng-init="loadEatings()" ng-cloak="">
            <h1>Приемы пищи</h1>
            <button ng-click="createEating()" class="btn btn-large btn-success">Поесть</button>
            {% verbatim %}
                <div ng-repeat="eating in eatings">
                    <span>
                        <div ng-click="eating.expand=!eating.expand">
                            <i ng-class='{"icon-chevron-down": eating.expand, "icon-chevron-right": !eating.expand}'></i>
                            {{ eating.pub_date|date:"dd MMMM H:mm:ss"|lowercase }}
                        </div>
                        <button class="btn btn-small btn-danger" ng-click="deleteEating(eating.id)">
                            <i class="icon-trash"></i>
                        </button>
                    </span>
                    <div class="eating-foods" ng-show="eating.expand">
                        <ul>
                            <li>
                                <form ng-controller="EatingFoodFormController" ng-submit="createEatingFood(eating.id)">
                                    <input type="hidden" ng-model="foodId" />
                                    <input type="text" ng-model="foodName" ng-required="" />
                                    <input type="text" ng-model="foodCount" maxlength="8" ng-maxlength="8" />
                                    <button class="btn btn-small btn-success">
                                        <i class="icon-plus"></i>
                                    </button>
                                </form>
                            </li>
                            <li ng-repeat="eatingfood in eating.eatingfoods">
                                {{ eatingfood.name }} {{ eatingfood.count }}
                                <button class="btn btn-small btn-danger" ng-click="deleteEatingFood(eating.id, eatingfood.id)">
                                    <i class="icon-minus"></i>
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
            {% endverbatim %}
        </div>
        <div class="span6" ng-controller="FoodController" ng-init="loadFoods()" ng-cloak="">
            <h1>Моя еда</h1>
            <ul>
                <li>
                    <form ng-controller="FoodController" ng-submit="createFood()">
                        <input type="text" ng-model="foodName" ng-required="" />
                        <button class="btn btn-small btn-success">
                            <i class="icon-plus"></i>
                        </button>
                    </form>
                </li>
                {% verbatim %}
                    <li ng-repeat="food in foods">
                        {{ food.name }}
                        <button class="btn btn-small btn-danger" ng-click="deleteFood(food.id)">
                            <i class="icon-minus"></i>
                        </button>
                    </li>
                {% endverbatim %}
            </ul>
        </div>
    </div>
{% endblock %}